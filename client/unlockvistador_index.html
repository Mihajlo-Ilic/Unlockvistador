<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Welcome to unlockvistador</title>
    <style>
        .serbia {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .form-popup {
            display: none;
            position: fixed;
            border: 3px solid #f1f1f1;
            z-index: 9;
        }
    </style>
</head>
<body class = "body">
    <h1>Welcome to unlockvistador!</h1> 
    <button type="submit" onclick="closeForm(`login`); openForm(`registration`)">Registracija</button>
    <div class="form-popup" id="formRegister">
        <form id="formReg" action="" class="form-container">
            <h3>Registrujte se:</h3>
            <label for="email"><b>E-mail:*</b></label>
            <input id="emailReg" type="text" name="email" placeholder="" required>
            <br>
            <label for="username"><b>Korisničko ime*:</b></label>
            <input id="usernameReg" type="text" name="username" placeholder="" required>
            <br>
            <label for="password"><b>Lozinka:*</b></label>
            <input id="passowordReg" type="text" name="password" placeholder="" required>
            <br>
            <label for="first_name"><b>Ime:</b></label>
            <input id="nameReg" type="text" name="first_name" placeholder="" >
            <br>
            <label for="last_name"><b>Prezime:</b></label>
            <input id="lastNameReg" type="text" name="last_name" placeholder="" >
            <br>
            <button type="submit">Registruj se</button>
            <button type="reset">Poništi</button>
            <button type="submit" onclick="closeForm(`registration`)">Zatvori formular</button>
        </form>
    </div>

    <button type="submit" onclick="closeForm(`registration`); openForm(`login`)">Prijava</button>
    <div class="form-popup" id="formLogin">
        <form id="formLog" action="" class="form-container">
            <h3>Prijavite se:</h3>
            <label for="email"><b>Mejl*:</b></label>
            <input id="emailLog" type="text" name="email" placeholder="" required>
            <br>
            <label for="password"><b>Lozinka:*</b></label>
            <input id="passwordLog" type="text" name="password" placeholder="" required>
            <br>
            <button type="submit">Prijavi se</button>
            <button type="reset">Poništi unos</button>
            <button type="submit" onclick="closeForm(`login`)">Zatvori formular</button>
        </form>
    </div>

    <svg class = "serbia" width="568" height="739">
        <!--G : Backa-->
    <polygon points="28,51,86,31,112,8,159,15,159,148,172,163,142,155,63,155,42,148" style="fill:lime;" 
    onmouseout="mouseOutHandlerBacka()"
    onmouseover="mouseOverHandlerBacka()"
    onclick="clickHandlerBacka()" 
    id = "BackaID"/>
        <!--G : Banat -->
    <polygon points="183,19,254,134,327,178,333,217,311,233,230,245,194,187,159,149,159,15" style="fill:yellow" 
    onmouseout="mouseOutHandlerBanat()"
    onmouseover="mouseOverHandlerBanat()"
    onclick="clickHandlerBanat()" 
    id = "BanatID"/>
        <!--G: Srem-->
    <polygon points="61,155,142,155,172,163,194,187,137,198,142,221,80,215,37,218,41,176,88,164" style="fill:rgb(24, 51, 126)" 
    onmouseout="mouseOutHandlerSrem()"
    onmouseover="mouseOverHandlerSrem()"
    onclick="clickHandlerSrem()" 
    id = "SremID"/>        
        <!--G: Beograd-->
    <polygon points="65,254,80,215,142,221,137,198,194,187,230,245,234,272" style="fill:rgb(126, 24, 121)" 
    onmouseout="mouseOutHandlerBeograd()"
    onmouseover="mouseOverHandlerBeograd()"
    onclick="clickHandlerBeograd()" 
    id = "BeogradID"/>  
        <!--G: Ist. Srbija-->
        <polygon points="305,420,251,372,229,245,311,233,383,260,400,287,434,247,474,271,440,286,465,314,465,325,429,364,428,413,308,413" style="fill:rgb(139, 153, 105)" 
    onmouseout="mouseOutHandlerIstok()"
    onmouseover="mouseOverHandlerIstok()"
    onclick="clickHandlerIstok()" 
    id = "IstokID"/>  
        <!--G: Sumadija -->
    <polygon points="106,358,53,314,53,279,65,254,234,271,251,372,305,420,295,444" style="fill:rgb(111, 92, 146)" 
    onmouseout="mouseOutHandlerSumadija()"
    onmouseover="mouseOverHandlerSumadija()"
    onclick="clickHandlerSumadija()" 
    id = "SumadijaID"/>  
        <!--G: Nisava -->
    <polygon points="374,652,380,581,338,562,343,546,279,483,308,412,428,413,507,500,440,560,444,628" style="fill:rgb(12, 53, 46)" 
    onmouseout="mouseOutHandlerNisava()"
    onmouseover="mouseOverHandlerNisava()"
    onclick="clickHandlerNisava()" 
    id = "NisavaID"/>  
        <!--G: Raska -->
    <polygon points="50,449,61,429,89,437,92,412,66,366,106,358,295,444,279,484,256,488,216,526,221,539,185,546" style="fill:rgb(51, 165, 140)" 
    onmouseout="mouseOutHandlerRaska()"
    onmouseover="mouseOverHandlerRaska()"
    onclick="clickHandlerRaska()" 
    id = "RaskaID"/>  
        <!--G: Kosovo i Metohija -->
    <polygon points="217,724,221,703,155,597,150,566,173,568,185,546,221,539,216,526,256,488,279,483,343,546,338,562,380,581,374,652,303,677,286,658,239,685,243,712" style="fill:rgb(177, 115, 15)" 
    onmouseout="mouseOutHandlerKosovo()"
    onmouseover="mouseOverHandlerKosovo()"
    onclick="clickHandlerKosovo()" 
    id = "KosovoID"/>  
        <!--G: Treba da se dodaju ostali regioni koji su na mapi!-->
    </svg> 
</body>
<script type="text/javascript" src="jquery-3.6.0.min.js"></script>
<script type="text/javascript">

    function sendGetReq(ime_oblasti) {
        $.ajax(`http://localhost:3000/${ime_oblasti}`, {
            method: "GET",
            success: function (data) {
                if(data.hasOwnProperty("message")) {
                    alert('Uspeh ' + data.message)
                }
                else if(data.hasOwnProperty("text")) {
                    alert(data.text + "\n" + data.answer)
                }
            },
            error: function (xhr, status, error) {
                var errorMessage = xhr.status + ': ' + xhr.statusText
                alert('Error - ' + errorMessage);
            }
        });
    }

    $("#formReg").submit(function(){
        let email = $("#emailReg").val();
        let username = $("#usernameReg").val();
        let password = $("#passwordReg").val();
        let name = $("#nameReg").val();
        let lastname = $("#lastNameReg").val();
        $.ajax(`http://localhost:3000/newUser`,{
            method: "POST",
            data: JSON.stringify({
                username, name, lastname, email, password
            }),
            contentType: "application/json",
            success: function(data) {
                alert("USPEH" + data.message);
            },
            error: function(xhr, status, error) {
                var errorMessage = xhr.status + ': ' + xhr.statusText
                alert('Error - ' + errorMessage);
            }
        });
    });

    $("#formLog").submit(function(){
        let email = $("#emailLog").val();
        let password = $("#passwordLog").val();
        $.ajax(`http://localhost:3000/signIn`,{
            data: JSON.stringify({
                email : email, 
                password : password
            }),
            method: "POST",
            contentType: "application/json",
            success: function(data) {
                alert("LOG IN");
            },
            error: function(xhr, status, error) {
                var errorMessage = xhr.status + ': ' + xhr.statusText
                alert("Lozinka ili mejl Vam nije korektno");
            }
        });
    });


    function openForm(form_name) {
        if(form_name == "registration")
            document.getElementById("formRegister").style.display = "block"
        else if(form_name == "login")
            document.getElementById("formLogin").style.display = "block"
    }

    function closeForm(form_name) {
        if(form_name == "registration")
            document.getElementById("formRegister").style.display = "none"
        else if(form_name == "login")
            document.getElementById("formLogin").style.display = "none"
    }

    function clickHandlerBanat() {
        sendGetReq("Banat")
    }
    function mouseOverHandlerBanat() {
        document.getElementById("BanatID").style = "fill:red";
    }
    function mouseOutHandlerBanat() {
        document.getElementById("BanatID").style = "fill:yellow";
    }

    function clickHandlerBacka() {
        sendGetReq("Backa")
    }
    function mouseOverHandlerBacka() {
        document.getElementById("BackaID").style = "fill:red";
    }
    function mouseOutHandlerBacka() {
        document.getElementById("BackaID").style = "fill:lime";
    }

    function clickHandlerSrem() {
        sendGetReq("Srem")
    }
    function mouseOverHandlerSrem() {
        document.getElementById("SremID").style = "fill:red";
    }
    function mouseOutHandlerSrem() {
        document.getElementById("SremID").style = "fill:rgb(24, 51, 126)";
    }

    function clickHandlerBeograd() {
        sendGetReq("Beograd")
    }
    function mouseOverHandlerBeograd() {
        document.getElementById("BeogradID").style = "fill:red";
    }
    function mouseOutHandlerBeograd() {
        document.getElementById("BeogradID").style = "fill:rgb(126, 24, 121)";
    }
    
    function clickHandlerIstok() {
        sendGetReq("Istok")
    }
    function mouseOverHandlerIstok() {
        document.getElementById("IstokID").style = "fill:red";
    }
    function mouseOutHandlerIstok() {
        document.getElementById("IstokID").style = "fill:rgb(139, 153, 105)";
    }

    function clickHandlerSumadija() {
        sendGetReq("Sumadija")
    }
    function mouseOverHandlerSumadija() {
        document.getElementById("SumadijaID").style = "fill:red";
    }
    function mouseOutHandlerSumadija() {
        document.getElementById("SumadijaID").style = "fill:rgb(111, 92, 146)";
    }

    function clickHandlerNisava() {
        sendGetReq("Nis")
    }
    function mouseOverHandlerNisava() {
        document.getElementById("NisavaID").style = "fill:red";
    }
    function mouseOutHandlerNisava() {
        document.getElementById("NisavaID").style = "fill:rgb(12, 53, 46)";
    }

    function clickHandlerRaska() {
        sendGetReq("Raska")
    }
    function mouseOverHandlerRaska() {
        document.getElementById("RaskaID").style = "fill:red";
    }
    function mouseOutHandlerRaska() {
        document.getElementById("RaskaID").style = "fill:rgb(51, 165, 140)";
    }

    function clickHandlerKosovo() {
        sendGetReq("Kosovo")
    }
    function mouseOverHandlerKosovo() {
        document.getElementById("KosovoID").style = "fill:red";
    }
    function mouseOutHandlerKosovo() {
        document.getElementById("KosovoID").style = "fill:rgb(177, 115, 15)";
    }
</script>
</html>